<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Donor Dashboard</title>
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      display: flex;
      min-height: 100vh;
      background: #f6f9fc;
    }

    /* Sidebar */
    .sidebar {
      width: 240px;
      background: linear-gradient(135deg, #1961b3, #f8f7f7);
      color: #fff;
      padding: 20px;
      display: flex;
      flex-direction: column;
      border-radius: 0 20px 20px 0;
      box-shadow: 2px 0 12px rgba(0,0,0,0.15);
    }

    .sidebar h3 {
      margin-bottom: 30px;
      font-size: 1.5rem;
      text-align: center;
    }

    .sidebar ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .sidebar ul li {
      margin: 12px 0;
    }

    .sidebar ul li a {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px;
      color: #fff;
      text-decoration: none;
      border-radius: 10px;
      transition: background 0.3s, transform 0.2s;
    }

    .sidebar ul li a:hover,
    .sidebar ul li a.active {
      background: rgba(255, 255, 255, 0.2);
      transform: translateX(4px);
    }

    /* Main */
    main {
      flex: 1;
      padding: 30px;
    }

    header {
      background: linear-gradient(135deg, #1961b3, #f8f7f7);
      color: #fff;
      padding: 18px 25px;
      border-radius: 15px;
      margin-bottom: 25px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    header h2 {
      margin: 0;
      font-size: 1.6rem;
    }

    .dashboard-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
    }

    .card {
      background: linear-gradient(135deg, #ffffff, #f9fbfd);
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      text-align: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .card:hover {
      transform: translateY(-6px);
      box-shadow: 0 12px 25px rgba(0,0,0,0.15);
    }

    .card h3 {
      margin-bottom: 12px;
      font-size: 1.2rem;
      color: #2980B9;
    }

    .card p {
      font-size: 2rem;
      font-weight: bold;
      color: #2C3E50;
    }

    /* Responsive */
    @media (max-width: 768px) {
      body {
        flex-direction: column;
      }
      .sidebar {
        width: 100%;
        border-radius: 0 0 20px 20px;
        flex-direction: row;
        justify-content: space-around;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      }
      .sidebar h3 {
        display: none;
      }
      .sidebar ul {
        display: flex;
        flex-direction: row;
      }
      .sidebar ul li {
        margin: 0 8px;
      }
      .sidebar ul li a {
        padding: 10px 14px;
        border-radius: 8px;
      }
      header {
        flex-direction: column;
        gap: 10px;
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <aside class="sidebar">
    <h3>Donor Panel</h3>
    <ul>
      <li><a href="dashboard.html" class="active">Dashboard</a></li>
      <li><a href="donate.html">Make Donation</a></li>
      <li><a href="donations.html">My Donations</a></li>
      <li><a href="profile.html">Profile</a></li>
      <li><a href="/logout">Logout</a></li>
    </ul>
  </aside>

  <main>
    <header>
      <h2>Welcome, Donor</h2>
      <span>❤️ Thank you for supporting FoodCare</span>
    </header>

    <div class="dashboard-cards">
      <div class="card">
        <h3>Total Donations</h3>
        <p id="total-donations">0</p>
      </div>
      <div class="card">
        <h3>Accepted</h3>
        <p id="accepted-donations">0</p>
      </div>
      <div class="card">
        <h3>Rejected</h3>
        <p id="rejected-donations">0</p>
      </div>
    </div>
  </main>

  <script>
    async function loadDonorDashboard() {
      try {
        const donor = await fetch('/api/auth/me', { credentials:'include' }).then(r=>r.json());
        const res = await fetch('/api/my-donations', { credentials:'include' });
        const donations = await res.json();

        document.getElementById('total-donations').textContent = donations.length;
        document.getElementById('accepted-donations').textContent = donations.filter(d => d.status === 'Accepted').length;
        document.getElementById('rejected-donations').textContent = donations.filter(d => d.status === 'Rejected').length;
      } catch(err) {
        console.error(err);
        alert('Failed to load dashboard');
      }
    }

    document.addEventListener('DOMContentLoaded', loadDonorDashboard);
  </script>
</body>
</html>
